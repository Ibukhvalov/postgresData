
CREATE OR REPLACE FUNCTION func.load_from_deeds_ministry()
 RETURNS trigger LANGUAGE plpgsql AS
$$
BEGIN
	NEW.number_of_good_deeds := floor(random() * 100);
	NEW.number_of_misdeeds := floor(random() * 100);
	RETURN NEW;
END;

$$;


CREATE OR REPLACE PROCEDURE init.create_trigger()
LANGUAGE plpgsql
SECURITY DEFINER
AS $$
BEGIN
CREATE OR REPLACE TRIGGER load_deeds_from_deed_ministry_trigger
BEFORE INSERT ON
data.child
FOR EACH ROW
EXECUTE PROCEDURE func.load_from_deeds_ministry();   
END;
$$;





CREATE OR REPLACE PROCEDURE init.create_indexes()
LANGUAGE plpgsql
SECURITY DEFINER
AS $$
BEGIN
CREATE EXTENSION IF NOT EXISTS pg_trgm;

CREATE INDEX topic_idx ON data.letter USING gin (topic gin_trgm_ops);
END;
$$;